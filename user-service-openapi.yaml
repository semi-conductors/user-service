openapi: 3.1.0
info:
  title: OpenAPI definition
  version: v0
servers:
  - url: 'http://localhost:8080'
    description: Generated server url
security:
  - bearerAuth: []
tags:
  - name: Identity Verification
    description: >-
      Endpoints for managing identity verification workflow. Users can submit
      verification requests with ID documents, and admins can review and
      approve/reject them. Includes cooldown mechanism to prevent spam
      submissions after rejection.
  - name: User Management
    description: >-
      Endpoints for managing user profiles, roles, and account status. Includes
      both self-service operations and administrative functions.
  - name: Authentication
    description: Authentication and authorization endpoints for user account management
  - name: Reports
    description: >-
      Report management system for handling user complaints, fraud detection,
      and dispute resolution. Supports different report types with role-based
      submission and admin resolution workflows.
  - name: Ratings & Feedback
    description: >-
      Endpoints for managing user ratings and feedback system. Users can rate
      each other after completed transactions to build trust profiles. Ratings
      automatically update denormalized average_rating and total_ratings on user
      records.
paths:
  /users/ratings:
    put:
      tags:
        - Ratings & Feedback
      summary: Update an existing rating
      description: >-
        Allows the original rater to update their previously submitted rating
        and feedback. Only the user who created the rating can update it
        (ownership verified by comparing rater_id with authenticated user). Can
        modify: - Rating value (1-5 stars) - Feedback text Automatically
        recalculates the rated user's average_rating and total_ratings. Updated
        timestamp is recorded for audit purposes.
      operationId: updateRating
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateRatingRequest'
        required: true
      responses:
        '200':
          description: Rating updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RatingResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: >-
            Not authorized to update this rating - only the original rater can
            update
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Rating not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
    post:
      tags:
        - Ratings & Feedback
      summary: Submit a rating for another user
      description: >-
        Creates a new rating (1-5 stars) with optional feedback for another user
        after a completed rental transaction. Constraints and validations: -
        Rating can only be submitted once per rental request (enforced by unique
        constraint on rental_request_id + rater_id) - Rated user must exist in
        the system - Rental request must be COMPLETED (validation to be
        implemented via cross-service check) - Rating value must be between 1-5
        (inclusive) - Automatically updates the rated user's average_rating and
        total_ratings fields Used to build trust and reputation in the platform.
      operationId: createRating
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRatingRequest'
        required: true
      responses:
        '201':
          description: Rating submitted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RatingResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Rated user not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users/profile:
    get:
      tags:
        - User Management
      summary: Get authenticated user's profile
      description: >-
        Retrieves the complete profile information of the currently
        authenticated user, including personal details, verification status,
        ratings, and account activity status. Requires valid JWT access token in
        Authorization header.
      operationId: getProfile
      responses:
        '200':
          description: Profile retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Not Found
                status: 404
                detail: User profile not found
                instance: /users/profile
      security:
        - bearerAuth: []
    put:
      tags:
        - User Management
      summary: Update authenticated user's profile
      description: >-
        Updates the personal information of the currently authenticated user.
        Allows modification of first name, last name, and phone number. Email
        and role cannot be changed through this endpoint. Phone number must be
        unique across all users.
      operationId: updateProfile
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserProfileRequest'
        required: true
      responses:
        '200':
          description: Profile updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
    delete:
      tags:
        - User Management
      summary: Deactivate own account (soft delete)
      description: >-
        Allows authenticated users to deactivate their own account. This is a
        soft delete operation - account is marked as disabled (is_disabled =
        true) and status set to INACTIVE. All active sessions are terminated.
        User data is preserved in the database for audit purposes. Note: This
        operation checks for active rentals (to be implemented) before allowing
        deactivation.
      operationId: deactivateOwnProfile
      responses:
        '204':
          description: Account successfully deactivated
          content:
            application/json: {}
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '409':
          description: >-
            Cannot deactivate account with active rentals (future
            implementation)
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users:
    get:
      tags:
        - User Management
      summary: List all users with filtering and pagination (Admin/Manager only)
      description: >-
        Retrieves a paginated list of all users in the system with advanced
        filtering capabilities. Supports filtering by role, account status,
        verification status, and keyword search (name, email, phone). Results
        can be sorted by various fields. Minimum search query length is 2
        characters. Useful for user management and moderation. Requires ADMIN or
        MANAGER role.
      operationId: getAllUsers
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
        - name: role
          in: query
          description: Filter by user role
          required: false
          schema:
            type: string
            enum:
              - USER
              - DELIVERY_GUY
              - ADMIN
              - MANAGER
          example: USER
        - name: status
          in: query
          description: Filter by account activity status
          required: false
          schema:
            type: string
            enum:
              - ACTIVE
              - INACTIVE
              - PENDING_REPORT_REVIEW
              - SUSPENDED_BY_ADMIN
        - name: isVerified
          in: query
          description: Filter by identity verification status
          required: false
          schema:
            type: boolean
        - name: search
          in: query
          description: >-
            Search keyword for name, email, or phone number (minimum 2
            characters)
          required: false
          schema:
            type: string
        - name: sortBy
          in: query
          description: Field to sort by
          required: false
          schema:
            type: string
            enum:
              - createdAt
              - updatedAt
              - averageRating
              - firstName
        - name: sortOrder
          in: query
          description: Sort direction
          required: false
          schema:
            type: string
            enum:
              - asc
              - desc
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserListResponse'
        '400':
          description: Invalid pagination or filter parameters
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
    post:
      tags:
        - User Management
      summary: Create new user account (Admin/Manager only)
      description: >-
        Allows administrators to create new user accounts with any role (USER,
        DELIVERY_GUY, ADMIN). Useful for onboarding platform staff (delivery
        personnel, admins) who don't self-register. Password is securely hashed
        before storage. Email and phone number must be unique. A
        UserRegisteredEvent is published upon successful creation. Requires
        ADMIN or MANAGER role.
      operationId: createProfile
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProfileRequest'
        required: true
      responses:
        '200':
          description: User account created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '400':
          description: Invalid input data or validation failed
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '409':
          description: Email or phone number already exists
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Conflict
                status: 409
                detail: User with this email or phone number already exists
                instance: /users
      security:
        - bearerAuth: []
  /users/verifications:
    get:
      tags:
        - Identity Verification
      summary: List all verification requests with filtering (Admin/Manager only)
      description: >-
        Retrieves a paginated list of all verification requests in the system.
        Supports filtering by status (PENDING, APPROVED, REJECTED) to prioritize
        review workload. Results can be sorted by creation date, review date, or
        ID. Useful for admins to manage the verification queue and track review
        metrics. Requires ADMIN or MANAGER role.
      operationId: getAll
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
        - name: status
          in: query
          description: Filter by verification status
          required: false
          schema:
            type: string
            enum:
              - PENDING
              - APPROVED
              - REJECTED
        - name: sortBy
          in: query
          description: Field to sort by
          required: false
          schema:
            type: string
            enum:
              - id
              - createdAt
              - reviewedAt
        - name: sortOrder
          in: query
          description: Sort direction
          required: false
          schema:
            type: string
            enum:
              - asc
              - desc
      responses:
        '200':
          description: Verification requests retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationListResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
    post:
      tags:
        - Identity Verification
      summary: Submit identity verification request
      description: >-
        Creates a new identity verification request with uploaded ID document
        URLs and ID number. User must first upload images to Cloudinary using
        the URLs from /upload-urls endpoint. Request is created with PENDING
        status and awaits admin review. Validation checks: - User doesn't have
        existing PENDING/APPROVED request - 48-hour cooldown period has passed
        since last rejection - ID number is exactly 14 digits - Image URLs are
        valid Cloudinary URLs
      operationId: createVerification
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateVerificationRequest'
        required: true
      responses:
        '201':
          description: Verification request created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Cannot submit - existing request or cooldown period active
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users/reports:
    get:
      tags:
        - Reports
      summary: Get all reports (Admin/Manager)
      description: >
        **Admin/Manager Only**


        Retrieve paginated list of all reports with advanced filtering
        capabilities.


        **Use Cases:**

        - Monitor all platform reports

        - Filter by specific criteria

        - Track resolution metrics

        - Identify patterns and trends
      operationId: getAllReports
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
        - name: status
          in: query
          description: Report status
          required: false
          schema:
            type: string
            enum:
              - PENDING
              - UNDER_REVIEW
              - RESOLVED
              - DISMISSED
        - name: type
          in: query
          description: Report type
          required: false
          schema:
            type: string
            enum:
              - FRAUD
              - DAMAGE
              - OVERDUE
              - FAKE_USER
              - THIEVING
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportListResponse'
      security:
        - bearerAuth: []
    post:
      tags:
        - Reports
      summary: Submit a new report
      description: >
        **Delivery Guy Only**


        Submit a report against another user involved in a delivery. Supported
        report types:

        - **FAKE_USER**: User didn't show up at delivery location

        - **FRAUD**: Item delivered is different/broken from listing

        - **OVERDUE**: Renter cannot be contacted for item return
        (auto-escalates to THIEVING after 72 hours)

        - **DAMAGE**: Item returned with damage (requires owner verification
        code)

        - **THIEVING**: Auto-generated from OVERDUE reports or manually created
        in severe cases


        **Business Rules:**

        - Only Delivery Guys can submit reports

        - reported_user_id must be associated with the delivery

        - Duplicate reports for same delivery are prevented
      operationId: createReport
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReportRequest'
        required: true
      responses:
        '201':
          description: Report submitted successfully
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportResponse'
      security:
        - bearerAuth: []
  '/users/reports/{id}/resolve':
    post:
      tags:
        - Reports
      summary: Resolve report
      description: |
        **Admin/Manager Only**

        Mark report as RESOLVED after investigation and action.

        **Actions Performed:**
        1. Updates report status to RESOLVED
        2. Records resolution timestamp and admin
        3. Releases lock automatically
        4. Sends notifications to all parties

        **For FRAUD/DAMAGE Reports:**
        - Triggers deposit transfer process (via Payment Service)
        - Calculates transfer amount based on damage_percentage
        - Creates financial transaction audit trail
        - Updates rental status

        **Use Cases:**
        - Confirmed fraud - initiate deposit transfer
        - Damage verified - process claim
        - Issue resolved - close report
        - Account action taken - document outcome
      operationId: resolve
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
      security:
        - bearerAuth: []
  '/users/reports/{id}/release':
    post:
      tags:
        - Reports
      summary: Release report lock
      description: |
        **Admin/Manager Only**

        Release your lock on a report without resolving it.

        **When to Use:**
        - Need to take a break
        - Report requires additional information
        - Passing to another admin
        - Cannot complete within 30 minutes

        **Effect:**
        - Removes lock (clears claimed_by, lock_expires_at)
        - Changes status back to PENDING
        - Report returns to available queue
        - Keeps assignment history for accountability

        **Note:** Lock is automatically released after 30 minutes of inactivity,
        but manual release is recommended for better team coordination.
      operationId: releaseReport
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Report lock released successfully
        '403':
          description: Forbidden - You don't have a lock on this report
        '404':
          description: Report not found
      security:
        - bearerAuth: []
  '/users/reports/{id}/refresh-lock':
    post:
      tags:
        - Reports
      summary: Refresh report lock (keep-alive)
      description: |
        **Admin/Manager Only**

        Extend the lock on a report you're actively working on.

        **Purpose:**
        - Prevent automatic lock expiration
        - Keep working on complex reports
        - Signal active work to other admins

        **Behavior:**
        - Extends lock by 30 minutes from now
        - Must be called before lock expires
        - Only works if you currently hold the lock

        **Recommended Usage:**
        - Call every 25 minutes for long reviews
        - Frontend should auto-refresh while admin is active
        - Helps differentiate active work from abandoned reports

        **Example Frontend Implementation:**
        ```javascript
        // Refresh every 25 minutes
        setInterval(() => {
          refreshLock(reportId);
        }, 25 * 60 * 1000);
        ```
      operationId: refreshLock
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                type: string
                format: date-time
      security:
        - bearerAuth: []
  '/users/reports/{id}/dismiss':
    post:
      tags:
        - Reports
      summary: Dismiss report
      description: >
        **Admin/Manager Only**


        Dismiss report as unfounded or invalid.


        **Prerequisites:**

        - Must have active lock on the report

        - Report must be in UNDER_REVIEW status

        - Dismissal requires detailed explanation


        **Actions Performed:**

        1. Updates report status to DISMISSED

        2. Records dismissal reason and admin

        3. Releases lock automatically

        4. Restores reported user's account status (if was
        PENDING_REPORT_REVIEW)

        5. Sends notifications to reporter and reported user


        **Dismissal Reasons (Examples):**

        - Insufficient evidence

        - Misunderstanding or miscommunication

        - Technical issue (not user fault)

        - Duplicate report


        **Important:**

        - Dismissal doesn't mean reporter was malicious

        - Document reasoning thoroughly

        - Consider pattern detection for false reporters

        - Reported user account status restored to ACTIVE


        **Use Cases:**

        - Lack of evidence to support claim

        - Situation resolved outside system

        - Report was mistake or misunderstanding

        - No platform policy violation found
      operationId: dismissReport
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
      security:
        - bearerAuth: []
  '/users/reports/{id}/claim':
    post:
      tags:
        - Reports
      summary: Claim report for review
      description: |
        **Admin/Manager Only**

        Claim a report to start working on it. This action:

        1. **Locks the report** to prevent others from editing
        2. **Changes status** from PENDING to UNDER_REVIEW
        3. **Sets 30-minute timer** - lock auto-expires if inactive
        4. **Records ownership** - tracks who is working on it

        **Lock Behavior:**
        - Lock expires after 30 minutes of inactivity
        - Can be refreshed while actively working
        - Automatically released on resolve/dismiss
        - Prevents duplicate work by multiple admins

        **Error Conditions:**
        - Report already claimed by another admin
        - Report not in PENDING status
        - Lock still active from previous claim

        **Use Cases:**
        - Start reviewing a report
        - Take ownership of investigation
        - Prevent conflicts with other admins
      operationId: claimReport
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
      security:
        - bearerAuth: []
  /users/auth/register:
    post:
      tags:
        - Authentication
      summary: Register a new user account
      description: >-
        Creates a new user account with USER role (default). Returns
        authentication tokens upon successful registration. Email and phone
        number must be unique. Password is securely hashed before storage.
      operationId: register
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
        required: true
      responses:
        '200':
          description: User successfully registered and authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '409':
          description: Conflict - Email or phone number already exists
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /users/auth/refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: >-
        Generates a new JWT access token using a valid refresh token. The
        refresh token must be active and not expired. A new refresh token is
        also issued, and the old refresh token is invalidated to prevent reuse.
      operationId: refresh
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogoutRequest'
        required: true
      responses:
        '200':
          description: New access token generated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshResponse'
        '401':
          description: Missing or invalid refresh token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Unauthorized
                status: 401
                detail: Refresh token expired or invalid
                instance: /users/auth/refresh
  /users/auth/password-reset/token:
    post:
      tags:
        - Authentication
      summary: Request password reset token
      description: >-
        Initiates the password reset process by generating a unique,
        time-limited token. If the email exists in the system, a reset token is
        sent via email (handled by notification service). Token expires after 60
        minutes by default. For security, the response is always 200 OK
        regardless of email existence.
      operationId: sendResetToken
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetTokenRequest'
        required: true
      responses:
        '200':
          description: Password reset request processed (check email if account exists)
          content:
            application/json: {}
  /users/auth/password-reset/confirm:
    post:
      tags:
        - Authentication
      summary: Confirm password reset with token
      description: >-
        Completes the password reset process using the token received via email.
        The token must be valid, unused, and not expired. Upon successful reset,
        the token is marked as used and cannot be reused. Password must meet
        security requirements (6-100 characters).
      operationId: resetPassword
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
        required: true
      responses:
        '200':
          description: Password successfully reset
          content:
            application/json: {}
        '404':
          description: 'Invalid token, or expired token.'
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Bad Request
                status: 400
                detail: Reset token is invalid or expired
                instance: /users/auth/password-reset/confirm
  /users/auth/logout:
    post:
      tags:
        - Authentication
      summary: Logout and invalidate refresh token
      description: >-
        Terminates the current user session by invalidating the refresh token.
        The access token will remain valid until expiration but the refresh
        token cannot be used to generate new tokens. All active sessions for the
        device will be terminated.
      operationId: logout
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LogoutRequest'
        required: true
      responses:
        '200':
          description: Successfully logged out
          content:
            application/json: {}
        '400':
          description: Invalid refresh token format
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Refresh token not found or already invalidated
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
  /users/auth/login:
    post:
      tags:
        - Authentication
      summary: Authenticate user and generate tokens
      description: >-
        Validates user credentials and returns JWT access token (short-lived)
        and refresh token (long-lived). Account must not be disabled. Use access
        token for authenticated requests and refresh token to obtain new access
        tokens.
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
        required: true
      responses:
        '200':
          description: Successfully authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          description: Invalid credentials or account disabled
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Unauthorized
                status: 401
                detail: Invalid email or password
                instance: /users/auth/login
  '/users/{id}/status':
    patch:
      tags:
        - User Management
      summary: Update user account status (Admin/Manager only)
      description: >-
        Allows administrators to change the account activity status of any user.
        Possible statuses: ACTIVE, INACTIVE, PENDING_REPORT_REVIEW,
        SUSPENDED_BY_ADMIN. When status is set to SUSPENDED_BY_ADMIN, the
        account is disabled and all active sessions are terminated. A
        ProfileDisabledEvent is published for suspended accounts. Requires ADMIN
        or MANAGER role.
      operationId: updateProfileStatus
      parameters:
        - name: id
          in: path
          description: User ID whose status to update
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProfileStatusRequest'
        required: true
      responses:
        '200':
          description: Account status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '400':
          description: Invalid status value or missing reason
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Forbidden
                status: 403
                detail: Access denied
                instance: /users/123/status
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/{id}/role':
    patch:
      tags:
        - User Management
      summary: Update user role (Admin/Manager only)
      description: >-
        Allows administrators to change the role of any user. Available roles:
        USER (1), DELIVERY_GUY (2), ADMIN (3), MANAGER (4). This operation
        should enforce role hierarchy restrictions (e.g., managers cannot
        promote users to manager role, users cannot demote themselves). Requires
        ADMIN or MANAGER role.
      operationId: updateProfileRole
      parameters:
        - name: id
          in: path
          description: User ID whose role to update
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProfileRoleRequest'
        required: true
      responses:
        '200':
          description: User role updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
        '400':
          description: Invalid role value or role hierarchy violation
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/verifications/{verificationId}/rejection':
    patch:
      tags:
        - Identity Verification
      summary: Reject verification request (Admin/Manager only)
      description: >-
        Rejects a pending identity verification request with a mandatory
        rejection reason. Actions performed: 1) Sets
        verification_requests.status = REJECTED 2) Stores the rejection reason
        for user feedback 3) Sets can_resubmit_after to current time + 48 hours
        (cooldown period) 4) Records reviewer ID and review timestamp 5)
        Publishes IdentityVerificationRejectedEvent for notification service
        User cannot submit a new request until the cooldown period expires.
        Requires ADMIN or MANAGER role.
      operationId: rejectVerification
      parameters:
        - name: verificationId
          in: path
          description: Verification request ID to reject
          required: true
          schema:
            type: integer
            format: int64
        - name: reason
          in: query
          description: Reason for rejection (will be shown to user)
          required: false
          schema:
            type: string
            default: no reason mentioned
      responses:
        '200':
          description: Verification request rejected successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationResponse'
        '400':
          description: Missing or invalid rejection reason
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Verification request not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/verifications/{verificationId}/approval':
    patch:
      tags:
        - Identity Verification
      summary: Approve verification request (Admin/Manager only)
      description: >-
        Approves a pending identity verification request and grants the user
        verified status. Actions performed: 1) Sets verification_requests.status
        = APPROVED 2) Updates users.is_identity_verified = TRUE 3) Records
        reviewer ID and review timestamp 4) Clears any rejection reason 5)
        Publishes IdentityVerificationApprovedEvent for notification service
        Requires ADMIN or MANAGER role.
      operationId: approveVerification
      parameters:
        - name: verificationId
          in: path
          description: Verification request ID to approve
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      responses:
        '200':
          description: Verification request approved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Verification request not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/{userId}/ratings':
    get:
      tags:
        - Ratings & Feedback
      summary: Get all ratings received by a user
      description: >-
        Retrieves a paginated list of all ratings and feedback received by a
        specific user. Results are sorted by creation date (most recent first).
        Includes rating score, feedback text, and rater information. Useful for
        viewing a user's trust profile and reputation before engaging in
        transactions. Available to all authenticated users for transparency.
      operationId: getUserRatings
      parameters:
        - name: userId
          in: path
          description: User ID whose ratings to retrieve
          required: true
          schema:
            type: integer
            format: int64
          example: 123
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
      responses:
        '200':
          description: Ratings retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/{id}':
    get:
      tags:
        - User Management
      summary: Get public user profile by ID
      description: >-
        Retrieves public profile information for any user by their ID. Returns
        only non-sensitive information including username, verification status,
        ratings, and role. Useful for viewing profiles of other users before
        transactions. Available to all authenticated users.
      operationId: getUser
      parameters:
        - name: id
          in: path
          description: User ID to retrieve
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      responses:
        '200':
          description: Public profile retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicUserProfileResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: User profile not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
              example:
                type: 'about:blank'
                title: Not Found
                status: 404
                detail: User profile not found
                instance: /users/123
      security:
        - bearerAuth: []
  '/users/{id}/details':
    get:
      tags:
        - User Management
      summary: Get user profile by ID (Admin/Manager only)
      description: Retrieves a single user profile by ID. Requires ADMIN or MANAGER role.
      operationId: getById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/UserProfileResponse'
      security:
        - bearerAuth: []
  '/users/verifications/{verificationId}':
    get:
      tags:
        - Identity Verification
      summary: Get detailed verification request (Admin/Manager only)
      description: >-
        Retrieves complete details of a specific verification request including:
        - ID document image URLs (with time-limited read access) - ID number and
        verification status - Submitter's profile information - Reviewer's
        profile information (if reviewed) - Submission and review timestamps
        Used by admins to review and make approval/rejection decisions. Requires
        ADMIN or MANAGER role.
      operationId: getVerification
      parameters:
        - name: verificationId
          in: path
          description: Verification request ID to retrieve
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      responses:
        '200':
          description: Verification details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationDetailsResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: Insufficient permissions - requires ADMIN or MANAGER role
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Verification request not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users/verifications/upload-urls:
    get:
      tags:
        - Identity Verification
      summary: Generate pre-signed Cloudinary upload URLs
      description: >-
        Generates secure, time-limited pre-signed URLs for uploading ID document
        images (front and back) to Cloudinary. Returns separate upload
        parameters for both front and back images. These URLs should be used to
        upload images directly to Cloudinary before submitting the verification
        request. Each URL includes: api_key, timestamp, signature, public_id,
        and upload endpoint.
      operationId: getUploadUrls
      responses:
        '200':
          description: Upload URLs generated successfully
          content:
            application/json:
              schema:
                type: string
              example:
                front:
                  api_key: ...
                  timestamp: 1234567890
                  signature: ...
                  public_id: id_front_uuid
                back:
                  api_key: ...
                  timestamp: 1234567890
                  signature: ...
                  public_id: id_back_uuid
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users/verifications/my-requests:
    get:
      tags:
        - Identity Verification
      summary: Get all verification requests for authenticated user
      description: >-
        Retrieves the complete history of all verification requests submitted by
        the authenticated user, including PENDING, APPROVED, and REJECTED
        requests. Useful for users to track their verification status and
        history. Returns requests sorted by creation date (most recent first).
      operationId: getMyRequests
      responses:
        '200':
          description: User's verification requests retrieved successfully
          content:
            application/json:
              schema:
                type: string
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  /users/verifications/can-submit:
    get:
      tags:
        - Identity Verification
      summary: Check if user can submit verification request
      description: >-
        Validates whether the authenticated user is eligible to submit a new
        verification request. Returns false if: 1) User already has a PENDING or
        APPROVED verification request, OR 2) User's last request was REJECTED
        and the 48-hour cooldown period hasn't elapsed. Use this endpoint before
        allowing users to start the verification process to provide clear
        feedback.
      operationId: canSubmit
      responses:
        '200':
          description: Eligibility check completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CanSubmitResponse'
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
  '/users/reports/{id}':
    get:
      tags:
        - Reports
      summary: Get detailed report information (Admin/Manager)
      description: |
        **Admin/Manager Only**

        Retrieve complete details for a specific report including:

        **Use Cases:**
        - Detailed report review before claiming
        - Investigation and evidence analysis
        - Resolution decision making
      operationId: getReport
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportDetailsResponse'
      security:
        - bearerAuth: []
  /users/reports/submitted:
    get:
      tags:
        - Reports
      summary: Get reports I submitted
      description: >
        Retrieve paginated list of all reports submitted by the authenticated
        user.


        **Access:** All authenticated users


        **Use Cases:**

        - Track my submitted reports

        - Monitor resolution progress

        - View report history
      operationId: getSubmittedReports
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportListResponse'
      security:
        - bearerAuth: []
  /users/reports/received:
    get:
      tags:
        - Reports
      summary: Get reports filed against me
      description: >
        Retrieve paginated list of all reports filed against the authenticated
        user.


        **Access:** All authenticated users


        **Use Cases:**

        - Monitor reports against me

        - Understand account status changes

        - Prepare responses or appeals
      operationId: getReceivedReports
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportListResponse'
      security:
        - bearerAuth: []
  /users/reports/available:
    get:
      tags:
        - Reports
      summary: Get claimable reports (Admin/Manager)
      description: |
        **Admin/Manager Only**

        Retrieve paginated list of reports available for claiming and review.

        **Availability Criteria:**
        - Status is PENDING
        - Not currently locked by another admin
        - Or lock has expired (auto-released after 30 minutes)

        **Workflow:**
        1. View available reports in dashboard
        2. Click to claim a report
        3. Review and resolve within 30 minutes (or refresh lock)
        4. Complete resolution or dismiss

        **Use Cases:**
        - Admin dashboard work queue
        - Priority-based triage
        - Load balancing across team
      operationId: getAvailableReports
      parameters:
        - name: page
          in: query
          description: Page number (1-based indexing)
          required: false
          schema:
            type: integer
            format: int32
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            format: int32
            default: 10
            maximum: 100
            minimum: 1
        - name: type
          in: query
          description: Report type
          required: false
          schema:
            type: string
            enum:
              - FRAUD
              - DAMAGE
              - OVERDUE
              - FAKE_USER
              - THIEVING
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ReportListResponse'
      security:
        - bearerAuth: []
  '/users/ratings/{ratingId}':
    delete:
      tags:
        - Ratings & Feedback
      summary: Delete a rating
      description: >-
        Allows the original rater to delete their previously submitted rating.
        Only the user who created the rating can delete it (ownership verified
        by comparing rater_id with authenticated user). This is a hard delete -
        the rating is permanently removed from the database. Automatically
        recalculates the rated user's average_rating and total_ratings after
        deletion. Use cases: - User wants to retract their rating - Rating was
        submitted in error Note: Consider implementing soft delete (is_visible
        flag) instead for audit trail preservation.
      operationId: deleteRating
      parameters:
        - name: ratingId
          in: path
          description: Rating ID to delete
          required: true
          schema:
            type: integer
            format: int64
          example: 123
      responses:
        '204':
          description: Rating deleted successfully
          content:
            application/json: {}
        '401':
          description: Missing or invalid authentication token
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '403':
          description: >-
            Not authorized to delete this rating - only the original rater can
            delete
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
        '404':
          description: Rating not found
          content:
            application/problem+json:
              schema:
                $ref: '#/components/schemas/ProblemDetail'
      security:
        - bearerAuth: []
components:
  schemas:
    UpdateRatingRequest:
      type: object
      description: >-
        Updated rating information including rating ID, new rating value (1-5),
        and feedback
      properties:
        ratingId:
          type: integer
          format: int64
        rating:
          type: integer
          format: int32
          maximum: 5
          minimum: 1
        feedback:
          type: string
      required:
        - ratingId
    RatingResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        raterUserId:
          type: integer
          format: int64
        ratedUserId:
          type: integer
          format: int64
        raterUserName:
          type: string
        rating:
          type: integer
          format: int32
        feedback:
          type: string
        createdAt:
          type: string
          format: date-time
    ProblemDetail:
      type: object
      properties:
        type:
          type: string
          format: uri
        title:
          type: string
        status:
          type: integer
          format: int32
        detail:
          type: string
        instance:
          type: string
          format: uri
        properties:
          type: object
          additionalProperties: {}
    UpdateUserProfileRequest:
      type: object
      description: 'Updated profile information (first name, last name, phone number)'
      properties:
        firstName:
          type: string
          minLength: 1
        lastName:
          type: string
          minLength: 1
        phoneNumber:
          type: string
          maxLength: 11
          minLength: 11
          pattern: '^[0-9]*$'
      required:
        - firstName
        - lastName
        - phoneNumber
    UserProfileResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        email:
          type: string
        username:
          type: string
        isVerified:
          type: boolean
        role:
          type: string
        phoneNumber:
          type: string
        accountActivity:
          type: string
        rating:
          type: number
          format: double
        totalRatings:
          type: integer
          format: int32
        memberSince:
          type: string
          format: date
    CreateProfileRequest:
      type: object
      description: User profile information including role
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        password:
          type: string
        phoneNumber:
          type: string
          maxLength: 11
          minLength: 11
          pattern: '^[0-9]*$'
        role:
          type: string
          enum:
            - USER
            - ADMIN
            - MANAGER
            - DELIVERY_GUY
      required:
        - firstName
        - lastName
        - password
        - phoneNumber
        - role
    CreateVerificationRequest:
      type: object
      description: Verification request with ID document URLs and ID number
      properties:
        idFrontImageUrl:
          type: string
          minLength: 1
        idBackImageUrl:
          type: string
          minLength: 1
        idNumber:
          type: string
          maxLength: 14
          minLength: 14
          pattern: '^[0-9]*$'
      required:
        - idBackImageUrl
        - idFrontImageUrl
    VerificationResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userId:
          type: integer
          format: int64
        idFrontImageUrl:
          type: string
        idBackImageUrl:
          type: string
        idNumber:
          type: string
        status:
          type: string
          enum:
            - PENDING
            - APPROVED
            - REJECTED
        submittedAt:
          type: string
          format: date-time
    CreateReportRequest:
      type: object
      properties:
        reportedUserId:
          type: integer
          format: int64
        reporterUserId:
          type: integer
          format: int64
        reportType:
          type: string
          enum:
            - FRAUD
            - DAMAGE
            - OVERDUE
            - FAKE_USER
        details:
          type: string
          maxLength: 2000
          minLength: 20
        relatedRentalId:
          type: integer
          format: int64
        relatedDeliveryId:
          type: integer
          format: int64
        damagePercentage:
          type: number
          maximum: 100
          minimum: 0
      required:
        - details
        - relatedDeliveryId
        - reportType
        - reportedUserId
        - reporterUserId
    ReportResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        reportType:
          type: string
          enum:
            - FRAUD
            - DAMAGE
            - OVERDUE
            - FAKE_USER
            - THIEVING
        status:
          type: string
          enum:
            - PENDING
            - UNDER_REVIEW
            - RESOLVED
            - DISMISSED
        reporterId:
          type: integer
          format: int64
        reporterName:
          type: string
        reportedUserId:
          type: integer
          format: int64
        reportedUserName:
          type: string
        details:
          type: string
        relatedRentalId:
          type: integer
          format: int64
        relatedDeliveryId:
          type: integer
          format: int64
        damagePercentage:
          type: number
        submittedAt:
          type: string
          format: date-time
        resolvedAt:
          type: string
          format: date-time
    CreateRatingRequest:
      type: object
      description: >-
        Rating details including rated user ID, rental request ID, rating value
        (1-5), and optional feedback
      properties:
        ratedUserId:
          type: integer
          format: int64
        rentalRequestId:
          type: integer
          format: int64
        rating:
          type: integer
          format: int32
          maximum: 5
          minimum: 1
        feedback:
          type: string
      required:
        - ratedUserId
        - rentalRequestId
    RegisterRequest:
      type: object
      description: User registration details
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        password:
          type: string
        phoneNumber:
          type: string
          maxLength: 11
          minLength: 11
          pattern: '^[0-9]*$'
      required:
        - firstName
        - lastName
        - password
        - phoneNumber
    LoginResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserProfileResponse'
        accessToken:
          type: string
        refreshToken:
          type: string
    LogoutRequest:
      type: object
      description: Refresh token to invalidate
      properties:
        refreshToken:
          type: string
          minLength: 1
      required:
        - refreshToken
    RefreshResponse:
      type: object
      properties:
        accessToken:
          type: string
    PasswordResetTokenRequest:
      type: object
      description: Email address of the account to reset
      properties:
        email:
          type: string
    PasswordResetRequest:
      type: object
      description: Password reset confirmation with token and new password
      properties:
        token:
          type: string
          minLength: 1
        newPassword:
          type: string
      required:
        - newPassword
        - token
    LoginRequest:
      type: object
      description: User login credentials
      properties:
        email:
          type: string
        password:
          type: string
      required:
        - email
        - password
    UpdateProfileStatusRequest:
      type: object
      description: New account status and reason for the change
      properties:
        status:
          type: string
          enum:
            - ACTIVE
            - INACTIVE
            - PENDING_REPORT_REVIEW
            - SUSPENDED_BY_ADMIN
        reason:
          type: string
          minLength: 1
      required:
        - reason
        - status
    UpdateProfileRoleRequest:
      type: object
      description: New role for the user
      properties:
        role:
          type: string
          enum:
            - USER
            - ADMIN
            - MANAGER
            - DELIVERY_GUY
    UserListResponse:
      type: object
      properties:
        currentPage:
          type: integer
          format: int32
        totalPages:
          type: integer
          format: int32
        totalItems:
          type: integer
          format: int64
        itemsPerPage:
          type: integer
          format: int32
        hasNext:
          type: boolean
        hasPrevious:
          type: boolean
        items: {}
    PagedResponse:
      type: object
      properties:
        currentPage:
          type: integer
          format: int32
        totalPages:
          type: integer
          format: int32
        totalItems:
          type: integer
          format: int64
        itemsPerPage:
          type: integer
          format: int32
        hasNext:
          type: boolean
        hasPrevious:
          type: boolean
        items: {}
    PublicUserProfileResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userName:
          type: string
        isVerified:
          type: boolean
        rating:
          type: number
          format: double
        totalRatings:
          type: integer
          format: int32
        role:
          type: string
    VerificationListResponse:
      type: object
      properties:
        currentPage:
          type: integer
          format: int32
        totalPages:
          type: integer
          format: int32
        totalItems:
          type: integer
          format: int64
        itemsPerPage:
          type: integer
          format: int32
        hasNext:
          type: boolean
        hasPrevious:
          type: boolean
        items: {}
    VerificationDetailsResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        idFrontImageUrl:
          type: string
        idBackImageUrl:
          type: string
        idNumber:
          type: string
        status:
          type: string
          enum:
            - PENDING
            - APPROVED
            - REJECTED
        submittedAt:
          type: string
          format: date-time
        submittedBy:
          $ref: '#/components/schemas/UserProfileResponse'
        verifiedBy:
          $ref: '#/components/schemas/UserProfileResponse'
    CanSubmitResponse:
      type: object
      properties:
        canSubmit:
          type: boolean
        message:
          type: string
        canSubmitAt:
          type: string
          format: date-time
    ReportListResponse:
      type: object
      properties:
        currentPage:
          type: integer
          format: int32
        totalPages:
          type: integer
          format: int32
        totalItems:
          type: integer
          format: int64
        itemsPerPage:
          type: integer
          format: int32
        hasNext:
          type: boolean
        hasPrevious:
          type: boolean
        items: {}
    ReportDetailsResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        reportType:
          type: string
          enum:
            - FRAUD
            - DAMAGE
            - OVERDUE
            - FAKE_USER
            - THIEVING
        status:
          type: string
          enum:
            - PENDING
            - UNDER_REVIEW
            - RESOLVED
            - DISMISSED
        details:
          type: string
        relatedRentalId:
          type: integer
          format: int64
        relatedDeliveryId:
          type: integer
          format: int64
        damagePercentage:
          type: number
        submittedAt:
          type: string
          format: date-time
        resolvedAt:
          type: string
          format: date-time
        claimedAt:
          type: string
          format: date-time
        lockExpiresAt:
          type: string
          format: date-time
        reporter:
          $ref: '#/components/schemas/UserProfileResponse'
        reported:
          $ref: '#/components/schemas/UserProfileResponse'
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
